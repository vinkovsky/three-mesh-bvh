var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},i=e.parcelRequire4485;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in n){var i=n[e];delete n[e];var o={id:e,exports:{}};return t[e]=o,i.call(o.exports,o,o.exports),o.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){n[e]=t},e.parcelRequire4485=i);var o=function(){var e=0,t=document.createElement("div");function n(e){return t.appendChild(e.dom),e}function i(n){for(var i=0;i<t.children.length;i++)t.children[i].style.display=i===n?"block":"none";e=n}t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",(function(n){n.preventDefault(),i(++e%t.children.length)}),!1);var a=(performance||Date).now(),r=a,d=0,s=n(new o.Panel("FPS","#0ff","#002")),l=n(new o.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=n(new o.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:t,addPanel:n,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){d++;var e=(performance||Date).now();if(l.update(e-a,200),e>r+1e3&&(s.update(1e3*d/(e-r),100),r=e,d=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:t,setMode:i}};o.Panel=function(e,t,n){var i=1/0,o=0,a=Math.round,r=a(window.devicePixelRatio||1),d=80*r,s=48*r,l=3*r,c=2*r,p=3*r,u=15*r,m=74*r,f=30*r,w=document.createElement("canvas");w.width=d,w.height=s,w.style.cssText="width:80px;height:48px";var h=w.getContext("2d");return h.font="bold "+9*r+"px Helvetica,Arial,sans-serif",h.textBaseline="top",h.fillStyle=n,h.fillRect(0,0,d,s),h.fillStyle=t,h.fillText(e,l,c),h.fillRect(p,u,m,f),h.fillStyle=n,h.globalAlpha=.9,h.fillRect(p,u,m,f),{dom:w,update:function(s,y){i=Math.min(i,s),o=Math.max(o,s),h.fillStyle=n,h.globalAlpha=1,h.fillRect(0,0,d,u),h.fillStyle=t,h.fillText(a(s)+" "+e+" ("+a(i)+"-"+a(o)+")",l,c),h.drawImage(w,p+r,u,m-r,f,p,u,m-r,f),h.fillRect(p+m-r,u,r,f),h.fillStyle=n,h.globalAlpha=.9,h.fillRect(p+m-r,u,r,a((1-s/y)*f))}}};var a=i("4Q0VG"),r=i("hGT0Q"),d=i("W2bOH"),s=i("7N5zk"),l=i("aBPXg");let c,p,u,m,f,w,h,y,x;r.Mesh.prototype.raycast=l.acceleratedRaycast,r.BufferGeometry.prototype.computeBoundsTree=l.computeBoundsTree,r.BufferGeometry.prototype.disposeBoundsTree=l.disposeBoundsTree;let g,b=new r.Vector3(0,0,1),v=!1,S=new r.Vector2,B=new r.Vector2,E=!1,T=!1,M=new r.Vector3,C=!1;const z={matcap:"Clay",size:.1,brush:"clay",intensity:50,maxSteps:10,invert:!1,symmetrical:!0,flatShading:!1,depth:10,displayHelper:!1},P={};function V(){w&&(w.geometry.dispose(),w.material.dispose(),p.remove(w));let e=new r.IcosahedronBufferGeometry(1,100);e.deleteAttribute("uv"),e=s.mergeVertices(e),e.attributes.position.setUsage(r.DynamicDrawUsage),e.attributes.normal.setUsage(r.DynamicDrawUsage),e.computeBoundsTree({setBoundingBox:!1}),w=new r.Mesh(e,g),w.frustumCulled=!1,p.add(w),x||(x=new l.MeshBVHVisualizer(w,z.depth),z.displayHelper&&p.add(x)),x.mesh=w,x.update()}function R(e,t,n=!1,i={}){const{accumulatedTriangles:o=new Set,accumulatedIndices:a=new Set,accumulatedTraversedNodeIndices:d=new Set}=i,s=new r.Matrix4;s.copy(w.matrixWorld).invert();const c=new r.Sphere;c.center.copy(e).applyMatrix4(s),c.radius=z.size;const p=new Set,u=new r.Vector3,m=new r.Vector3,f=w.geometry.index,h=w.geometry.attributes.position,y=w.geometry.attributes.normal,x=new Set;w.geometry.boundsTree.shapecast({intersectsBounds:(e,t,n,i,o)=>{d.add(o);const a=c.intersectsBox(e),{min:r,max:s}=e;if(a){for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++)if(u.set(0===e?r.x:s.x,0===t?r.y:s.y,0===n?r.z:s.z),!c.containsPoint(u))return l.INTERSECTED;return l.CONTAINED}return a?l.INTERSECTED:l.NOT_INTERSECTED},intersectsTriangle:(e,t,n)=>{const i=t;x.add(i),o.add(i);const r=3*t,d=r+0,s=r+1,l=r+2,u=f.getX(d),m=f.getX(s),w=f.getX(l);return n?(p.add(u),p.add(m),p.add(w),a.add(u),a.add(m),a.add(w)):(c.containsPoint(e.a)&&(p.add(u),a.add(u)),c.containsPoint(e.b)&&(p.add(m),a.add(m)),c.containsPoint(e.c)&&(p.add(w),a.add(w))),!1}});const g=new r.Vector3;g.copy(e).applyMatrix4(s);const v=new r.Vector3;let S=0;if(p.forEach((e=>{u.fromBufferAttribute(y,e),m.add(u),n||(S++,u.fromBufferAttribute(h,e),v.add(u))})),m.normalize(),t.quaternion.setFromUnitVectors(b,m),S&&v.multiplyScalar(1/S),n)return;const B=1e-4*z.intensity,E=new r.Plane;E.setFromNormalAndCoplanarPoint(m,v),p.forEach((e=>{u.fromBufferAttribute(h,e);const t=u.distanceTo(g),n=z.invert!==C?-1:1;let i=1-t/z.size;if("clay"===z.brush){i=Math.pow(i,3);const e=E.distanceToPoint(u),t=n*Math.min(4*i,1);u.addScaledVector(m,t*B-n*e*t*.3)}else if("normal"===z.brush)i=Math.pow(i,2),u.addScaledVector(m,n*i*B);else if("flatten"===z.brush){i=Math.pow(i,2);const e=E.distanceToPoint(u);u.addScaledVector(m,-e*i*z.intensity*.005)}h.setXYZ(e,u.x,u.y,u.z),y.setXYZ(e,0,0,0)})),p.size&&(h.needsUpdate=!0)}!function(){m=new r.WebGLRenderer({antialias:!0}),m.setPixelRatio(window.devicePixelRatio),m.setSize(window.innerWidth,window.innerHeight),m.setClearColor(394761,1),m.outputEncoding=r.sRGBEncoding,document.body.appendChild(m.domElement),m.domElement.style.touchAction="none",p=new r.Scene,p.fog=new r.Fog(1251612,20,60);const e=new r.DirectionalLight(16777215,.5);e.position.set(1,1,1),p.add(e),p.add(new r.AmbientLight(16777215,.4));const t=[new r.Vector3,new r.Vector3(0,0,1)];for(let e=0;e<50;e++){const n=e+1,i=Math.sin(2*Math.PI*e/50),o=Math.cos(2*Math.PI*e/50),a=Math.sin(2*Math.PI*n/50),d=Math.cos(2*Math.PI*n/50);t.push(new r.Vector3(i,o,0),new r.Vector3(a,d,0))}h=new r.LineSegments,h.geometry.setFromPoints(t),h.material.color.set(16485376),p.add(h),y=h.clone(),p.add(y),u=new r.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50),u.position.set(0,0,3),u.far=100,u.updateProjectionMatrix(),c=new o,document.body.appendChild(c.dom),P.Clay=(new r.TextureLoader).load("../textures/B67F6B_4B2E2A_6C3A34_F3DBC6-256px.png"),P["Red Wax"]=(new r.TextureLoader).load("../textures/763C39_431510_210504_55241C-256px.png"),P["Shiny Green"]=(new r.TextureLoader).load("../textures/3B6E10_E3F2C3_88AC2E_99CE51-256px.png"),P.Normal=(new r.TextureLoader).load("../textures/7877EE_D87FC5_75D9C7_1C78C0-256px.png"),g=new r.MeshMatcapMaterial({flatShading:z.flatShading});for(const e in P)P[e].encoding=r.sRGBEncoding;V();const n=new a.GUI;n.add(z,"matcap",Object.keys(P));const i=n.addFolder("Sculpting");i.add(z,"brush",["normal","clay","flatten"]),i.add(z,"size").min(.025).max(.25).step(.005),i.add(z,"intensity").min(1).max(100).step(1),i.add(z,"maxSteps").min(1).max(25).step(1),i.add(z,"symmetrical"),i.add(z,"invert"),i.add(z,"flatShading").onChange((e=>{w.material.flatShading=e,w.material.needsUpdate=!0})),i.open();const s=n.addFolder("BVH Helper");s.add(z,"depth").min(1).max(20).step(1).onChange((e=>{x.depth=parseFloat(e),x.update()})),s.add(z,"displayHelper").onChange((e=>{e?(p.add(x),x.update()):p.remove(x)})),s.open(),n.add({reset:V},"reset"),n.add({rebuildBVH:()=>{w.geometry.computeBoundsTree({setBoundingBox:!1}),x.update()}},"rebuildBVH"),n.open(),window.addEventListener("resize",(function(){u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),m.setSize(window.innerWidth,window.innerHeight)}),!1),window.addEventListener("pointermove",(function(e){S.x=e.clientX/window.innerWidth*2-1,S.y=-e.clientY/window.innerHeight*2+1,v=!0})),window.addEventListener("pointerdown",(e=>{S.x=e.clientX/window.innerWidth*2-1,S.y=-e.clientY/window.innerHeight*2+1,E=Boolean(3&e.buttons),C=Boolean(2&e.buttons),v=!0;const t=new r.Raycaster;t.setFromCamera(S,u),t.firstHitOnly=!0;const n=t.intersectObject(w);f.enabled=0===n.length}),!0),window.addEventListener("pointerup",(e=>{E=Boolean(3&e.buttons),"touch"===e.pointerType&&(v=!1)})),window.addEventListener("contextmenu",(function(e){e.preventDefault()})),window.addEventListener("wheel",(function(e){let t=e.deltaY;1===e.deltaMode&&(t*=40),2===e.deltaMode&&(t*=40),z.size+=1e-4*t,z.size=Math.max(Math.min(z.size,.25),.025),n.updateDisplay()})),f=new d.OrbitControls(u,m.domElement),f.minDistance=1.5,f.addEventListener("start",(function(){this.active=!0})),f.addEventListener("end",(function(){this.active=!1}))}(),function e(){if(requestAnimationFrame(e),c.begin(),g.matcap=P[z.matcap],f.active||!v)h.visible=!1,y.visible=!1,M.setScalar(1/0);else{const e=new r.Raycaster;e.setFromCamera(S,u),e.firstHitOnly=!0;const t=e.intersectObject(w,!0)[0];if(t)if(h.visible=!0,h.scale.set(z.size,z.size,.1),h.position.copy(t.point),y.visible=z.symmetrical,y.scale.set(z.size,z.size,.1),y.position.copy(t.point),y.position.x*=-1,f.enabled=!1,M.x===1/0&&M.copy(t.point),E||T){const e=(S.x-B.x)*window.innerWidth*window.devicePixelRatio,n=(S.y-B.y)*window.innerHeight*window.devicePixelRatio;let i=Math.sqrt(e*e+n*n),o=t.point.distanceTo(M);const a=.15*z.size,d=Math.max(a/o,1/z.maxSteps),s=i*d;let l=0;const c=new Set,p=new Set,u=new Set,m={accumulatedTriangles:c,accumulatedIndices:p,accumulatedTraversedNodeIndices:u};for(;o>a&&i>200*z.size/t.distance&&(B.lerp(S,d),M.lerp(t.point,d),o-=a,i-=s,R(M,h,!1,m),z.symmetrical&&(M.x*=-1,R(M,y,!1,m),M.x*=-1),l++,!(l>z.maxSteps)););l>0?(!function(e,t){const n=new r.Vector3,i=new r.Vector3,o=w.geometry.index,a=w.geometry.attributes.position,d=w.geometry.attributes.normal,s=new r.Triangle;e.forEach((e=>{const r=3*e,l=r+0,c=r+1,p=r+2,u=o.getX(l),m=o.getX(c),f=o.getX(p);s.a.fromBufferAttribute(a,u),s.b.fromBufferAttribute(a,m),s.c.fromBufferAttribute(a,f),s.getNormal(i),t.has(u)&&(n.fromBufferAttribute(d,u),n.add(i),d.setXYZ(u,n.x,n.y,n.z)),t.has(m)&&(n.fromBufferAttribute(d,m),n.add(i),d.setXYZ(m,n.x,n.y,n.z)),t.has(f)&&(n.fromBufferAttribute(d,f),n.add(i),d.setXYZ(f,n.x,n.y,n.z))})),t.forEach((e=>{n.fromBufferAttribute(d,e),n.normalize(),d.setXYZ(e,n.x,n.y,n.z)})),d.needsUpdate=!0}(c,p),w.geometry.boundsTree.refit(u),null!==x.parent&&x.update()):(R(t.point,h,!0),z.symmetrical&&(t.point.x*=-1,R(t.point,y,!0),t.point.x*=-1))}else R(t.point,h,!0),z.symmetrical&&(t.point.x*=-1,R(t.point,y,!0),t.point.x*=-1),B.copy(S),M.copy(t.point);else f.enabled=!0,h.visible=!1,y.visible=!1,B.copy(S),M.setScalar(1/0)}T=E,m.render(p,u),c.end()}();
//# sourceMappingURL=sculpt.1420ff81.js.map
