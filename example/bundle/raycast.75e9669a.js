function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},a=t.parcelRequire4485;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var a={id:e,exports:{}};return n[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},t.parcelRequire4485=a);var r,i,s={};r=s,i=function(){var e=function(){function t(e){return a.appendChild(e.dom),e}function n(e){for(var t=0;t<a.children.length;t++)a.children[t].style.display=t===e?"block":"none";o=e}var o=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",(function(e){e.preventDefault(),n(++o%a.children.length)}),!1);var r=(performance||Date).now(),i=r,s=0,d=t(new e.Panel("FPS","#0ff","#002")),l=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:a,addPanel:t,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(l.update(e-r,200),e>i+1e3&&(d.update(1e3*s/(e-i),100),i=e,s=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){r=this.end()},domElement:a,setMode:n}};return e.Panel=function(e,t,n){var o=1/0,a=0,r=Math.round,i=r(window.devicePixelRatio||1),s=80*i,d=48*i,l=3*i,c=2*i,p=3*i,u=15*i,h=74*i,m=30*i,f=document.createElement("canvas");f.width=s,f.height=d,f.style.cssText="width:80px;height:48px";var y=f.getContext("2d");return y.font="bold "+9*i+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=n,y.fillRect(0,0,s,d),y.fillStyle=t,y.fillText(e,l,c),y.fillRect(p,u,h,m),y.fillStyle=n,y.globalAlpha=.9,y.fillRect(p,u,h,m),{dom:f,update:function(d,w){o=Math.min(o,d),a=Math.max(a,d),y.fillStyle=n,y.globalAlpha=1,y.fillRect(0,0,s,u),y.fillStyle=t,y.fillText(r(d)+" "+e+" ("+r(o)+"-"+r(a)+")",l,c),y.drawImage(f,p+i,u,h-i,m,p,u,h-i,m),y.fillRect(p+h-i,u,i,m),y.fillStyle=n,y.globalAlpha=.9,y.fillRect(p+h-i,u,i,r((1-d/w)*m))}}},e},"object"==typeof s?s=i():"function"==typeof define&&define.amd?define(i):r.Stats=i();var d=a("4Q0VG"),l=a("hGT0Q"),c=a("aBPXg");l.Mesh.prototype.raycast=c.acceleratedRaycast,l.BufferGeometry.prototype.computeBoundsTree=c.computeBoundsTree,l.BufferGeometry.prototype.disposeBoundsTree=c.disposeBoundsTree;let p,u,h,m,f,y,w,g;const x=[],M=[],v=new l.Raycaster,S=new l.SphereGeometry(.25,20,20),T=new l.CylinderGeometry(.01,.01);let b=null,B=0;const E={raycasters:{count:150,speed:1},mesh:{splitStrategy:c.CENTER,count:1,useBoundsTree:!0,visualizeBounds:!1,displayParents:!1,speed:1,visualBoundsDepth:10}};function P(){const e=new l.Mesh(f,y);e.rotation.x=10*Math.random(),e.rotation.y=10*Math.random(),x.push(e),g.add(e)}function R(){const e=new l.Object3D,t=new l.MeshBasicMaterial({color:16777215}),n=new l.Mesh(S,t),o=new l.Mesh(S,t);o.scale.multiplyScalar(.25),n.scale.multiplyScalar(.5);const a=new l.Mesh(T,new l.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.25}));e.add(a),e.add(n),e.add(o),u.add(e),n.position.set(25,0,0),e.rotation.x=10*Math.random(),e.rotation.y=10*Math.random(),e.rotation.z=10*Math.random();const r=new l.Vector3,i=new l.Vector3,s=Math.random()-.5,d=Math.random()-.5,c=Math.random()-.5;M.push({update:()=>{e.rotation.x+=1e-4*s*E.raycasters.speed*B,e.rotation.y+=1e-4*d*E.raycasters.speed*B,e.rotation.z+=1e-4*c*E.raycasters.speed*B,n.updateMatrixWorld(),r.setFromMatrixPosition(n.matrixWorld),i.copy(r).multiplyScalar(-1).normalize(),v.set(r,i),v.firstHitOnly=!0;const t=v.intersectObject(g,!0),l=t.length?t[0].distance:25;o.position.set(25-l,0,0),a.position.set(25-l/2,0,0),a.scale.set(1,l,1),a.rotation.z=Math.PI/2},remove:()=>{u.remove(e)}})}function C(){for(;M.length>E.raycasters.count;)M.pop().remove();for(;M.length<E.raycasters.count;)R();if(!f)return;(!E.mesh.useBoundsTree&&f.boundsTree||f.boundsTree&&E.mesh.splitStrategy!==f.boundsTree.splitStrategy)&&f.disposeBoundsTree(),E.mesh.useBoundsTree&&!f.boundsTree&&(console.time("computing bounds tree"),f.computeBoundsTree({maxLeafTris:5,strategy:parseFloat(E.mesh.splitStrategy)}),f.boundsTree.splitStrategy=E.mesh.splitStrategy,console.timeEnd("computing bounds tree"),w&&w.update());const e=x.length;for(;x.length>E.mesh.count;)g.remove(x.pop());for(;x.length<E.mesh.count;)P();if(e!==x.length){const e=(e,t,n)=>e+(t-e)*n,t=(x.length-1)/299,n=e(0,2,t),o=e(1,.2,t);x.forEach((e=>{e.scale.set(1,1,1).multiplyScalar(o);const t=new l.Vector3(0,1,0);t.applyAxisAngle(new l.Vector3(1,0,0),Math.PI*Math.random()),t.applyAxisAngle(new l.Vector3(0,1,0),2*Math.PI*Math.random()),t.multiplyScalar(n),e.position.set(t.x,t.y,t.z)}))}const t=E.mesh.visualizeBounds&&f.boundsTree;w&&!t&&(g.remove(w),w=null),!w&&t&&(w=new c.MeshBVHVisualizer(x[0]),g.add(w)),w&&(w.depth=E.mesh.visualBoundsDepth,w.displayParents=E.mesh.displayParents,w.update())}!function(){p=new l.WebGLRenderer({antialias:!0}),p.setPixelRatio(window.devicePixelRatio),p.setSize(window.innerWidth,window.innerHeight),p.setClearColor(1251612,1),document.body.appendChild(p.domElement),u=new l.Scene,u.fog=new l.Fog(1251612,20,60);const t=new l.DirectionalLight(16777215,.5);t.position.set(1,1,1),u.add(t),u.add(new l.AmbientLight(16777215,.4));g=new l.Object3D,f=new l.TorusKnotBufferGeometry(1,.4,400,100),y=new l.MeshPhongMaterial({color:15277667}),g.scale.multiplyScalar(10),g.rotation.x=10.989999999999943,g.rotation.y=10.989999999999943,u.add(g),m=new l.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50),m.position.z=40,m.far=100,m.updateProjectionMatrix(),h=new(e(s)),document.body.appendChild(h.dom);const n=new d.GUI,o=n.addFolder("Raycasters");o.add(E.raycasters,"count").min(1).max(1e3).step(1).onChange((()=>C())),o.add(E.raycasters,"speed").min(0).max(20),o.open();const a=n.addFolder("Mesh");a.add(E.mesh,"useBoundsTree").onChange((()=>C())),a.add(E.mesh,"splitStrategy",{CENTER:c.CENTER,SAH:c.SAH,AVERAGE:c.AVERAGE}).onChange((()=>C())),a.add(E.mesh,"count").min(1).max(300).step(1).onChange((()=>C())),a.add(E.mesh,"speed").min(0).max(20),a.add(E.mesh,"visualizeBounds").onChange((()=>C())),a.add(E.mesh,"displayParents").onChange((()=>C())),a.add(E.mesh,"visualBoundsDepth").min(1).max(20).step(1).onChange((()=>C())),a.open(),window.addEventListener("resize",(function(){m.aspect=window.innerWidth/window.innerHeight,m.updateProjectionMatrix(),p.setSize(window.innerWidth,window.innerHeight)}),!1)}(),C(),function e(){h.begin();const t=window.performance.now();b=b||t,B=t-b,g.rotation.x+=1e-4*E.mesh.speed*B,g.rotation.y+=1e-4*E.mesh.speed*B,g.children.forEach((e=>{e.rotation.x+=1e-4*E.mesh.speed*B,e.rotation.y+=1e-4*E.mesh.speed*B})),g.updateMatrixWorld(),M.forEach((e=>e.update())),p.render(u,m),b=t,h.end(),requestAnimationFrame(e)}();
//# sourceMappingURL=raycast.75e9669a.js.map
