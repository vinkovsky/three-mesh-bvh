function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},n={},i=t.parcelRequire4485;null==i&&((i=function(e){if(e in a)return a[e].exports;if(e in n){var t=n[e];delete n[e];var i={id:e,exports:{}};return a[e]=i,t.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},t.parcelRequire4485=i);var o=i("hGT0Q");const r=new((o=i("hGT0Q")).Vector3);function s(e,t,a,n,i,o){const s=2*Math.PI*i/4,d=Math.max(o-2*i,0),l=Math.PI/4;r.copy(t),r[n]=0,r.normalize();const c=.5*s/(s+d),p=1-r.angleTo(e)/l;if(1===Math.sign(r[a]))return p*c;return d/(s+d)+c+c*(1-p)}class d extends o.BoxGeometry{constructor(e=1,t=1,a=1,n=2,i=.1){if(n=2*n+1,i=Math.min(e/2,t/2,a/2,i),super(1,1,1,n,n,n),1===n)return;const r=this.toNonIndexed();this.index=null,this.attributes.position=r.attributes.position,this.attributes.normal=r.attributes.normal,this.attributes.uv=r.attributes.uv;const d=new o.Vector3,l=new o.Vector3,c=new o.Vector3(e,t,a).divideScalar(2).subScalar(i),p=this.attributes.position.array,u=this.attributes.normal.array,h=this.attributes.uv.array,m=p.length/6,y=new o.Vector3,f=.5/n;for(let n=0,o=0;n<p.length;n+=3,o+=2){d.fromArray(p,n),l.copy(d),l.x-=Math.sign(l.x)*f,l.y-=Math.sign(l.y)*f,l.z-=Math.sign(l.z)*f,l.normalize(),p[n+0]=c.x*Math.sign(d.x)+l.x*i,p[n+1]=c.y*Math.sign(d.y)+l.y*i,p[n+2]=c.z*Math.sign(d.z)+l.z*i,u[n+0]=l.x,u[n+1]=l.y,u[n+2]=l.z;switch(Math.floor(n/m)){case 0:y.set(1,0,0),h[o+0]=s(y,l,"z","y",i,a),h[o+1]=1-s(y,l,"y","z",i,t);break;case 1:y.set(-1,0,0),h[o+0]=1-s(y,l,"z","y",i,a),h[o+1]=1-s(y,l,"y","z",i,t);break;case 2:y.set(0,1,0),h[o+0]=1-s(y,l,"x","z",i,e),h[o+1]=s(y,l,"z","x",i,a);break;case 3:y.set(0,-1,0),h[o+0]=1-s(y,l,"x","z",i,e),h[o+1]=1-s(y,l,"z","x",i,a);break;case 4:y.set(0,0,1),h[o+0]=1-s(y,l,"x","y",i,e),h[o+1]=1-s(y,l,"y","x",i,t);break;case 5:y.set(0,0,-1),h[o+0]=s(y,l,"x","y",i,e),h[o+1]=1-s(y,l,"y","x",i,t)}}}}var l,c,p=i("4EHgc"),u=i("W2bOH"),h=i("7N5zk"),m={};l=m,c=function(){var e=function(){function t(e){return i.appendChild(e.dom),e}function a(e){for(var t=0;t<i.children.length;t++)i.children[t].style.display=t===e?"block":"none";n=e}var n=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(e){e.preventDefault(),a(++n%i.children.length)}),!1);var o=(performance||Date).now(),r=o,s=0,d=t(new e.Panel("FPS","#0ff","#002")),l=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new e.Panel("MB","#f08","#201"));return a(0),{REVISION:16,dom:i,addPanel:t,showPanel:a,begin:function(){o=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(l.update(e-o,200),e>r+1e3&&(d.update(1e3*s/(e-r),100),r=e,s=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){o=this.end()},domElement:i,setMode:a}};return e.Panel=function(e,t,a){var n=1/0,i=0,o=Math.round,r=o(window.devicePixelRatio||1),s=80*r,d=48*r,l=3*r,c=2*r,p=3*r,u=15*r,h=74*r,m=30*r,y=document.createElement("canvas");y.width=s,y.height=d,y.style.cssText="width:80px;height:48px";var f=y.getContext("2d");return f.font="bold "+9*r+"px Helvetica,Arial,sans-serif",f.textBaseline="top",f.fillStyle=a,f.fillRect(0,0,s,d),f.fillStyle=t,f.fillText(e,l,c),f.fillRect(p,u,h,m),f.fillStyle=a,f.globalAlpha=.9,f.fillRect(p,u,h,m),{dom:y,update:function(d,w){n=Math.min(n,d),i=Math.max(i,d),f.fillStyle=a,f.globalAlpha=1,f.fillRect(0,0,s,u),f.fillStyle=t,f.fillText(o(d)+" "+e+" ("+o(n)+"-"+o(i)+")",l,c),f.drawImage(y,p+r,u,h-r,m,p,u,h-r,m),f.fillRect(p+h-r,u,r,m),f.fillStyle=a,f.globalAlpha=.9,f.fillRect(p+h-r,u,r,o((1-d/w)*m))}}},e},"object"==typeof m?m=c():"function"==typeof define&&define.amd?define(c):l.Stats=c();var y=i("4Q0VG"),f=i("aBPXg");const w={firstPerson:!1,displayCollider:!1,displayBVH:!1,visualizeDepth:10,gravity:-30,playerSpeed:10,physicsSteps:5,reset:_};let g,x,S,b,M,v,z,V,P,A,B,C=!1,k=!1,E=!1,D=!1,W=!1,H=new o.Vector3,T=new o.Vector3(0,1,0),R=new o.Vector3,G=new o.Vector3,L=new o.Box3,I=new o.Matrix4,F=new o.Line3;function _(){H.set(0,0,0),A.position.set(15.75,-3,30),x.position.sub(B.target),B.target.copy(A.position),x.position.add(A.position),B.update()}function K(e){H.y+=C?0:e*w.gravity,A.position.addScaledVector(H,e);const t=B.getAzimuthalAngle();k&&(R.set(0,0,-1).applyAxisAngle(T,t),A.position.addScaledVector(R,w.playerSpeed*e)),E&&(R.set(0,0,1).applyAxisAngle(T,t),A.position.addScaledVector(R,w.playerSpeed*e)),D&&(R.set(-1,0,0).applyAxisAngle(T,t),A.position.addScaledVector(R,w.playerSpeed*e)),W&&(R.set(1,0,0).applyAxisAngle(T,t),A.position.addScaledVector(R,w.playerSpeed*e)),A.updateMatrixWorld();const a=A.capsuleInfo;L.makeEmpty(),I.copy(V.matrixWorld).invert(),F.copy(a.segment),F.start.applyMatrix4(A.matrixWorld).applyMatrix4(I),F.end.applyMatrix4(A.matrixWorld).applyMatrix4(I),L.expandByPoint(F.start),L.expandByPoint(F.end),L.min.addScalar(-a.radius),L.max.addScalar(a.radius),V.geometry.boundsTree.shapecast({intersectsBounds:e=>e.intersectsBox(L),intersectsTriangle:e=>{const t=R,n=G,i=e.closestPointToSegment(F,t,n);if(i<a.radius){const e=a.radius-i,o=n.sub(t).normalize();F.start.addScaledVector(o,e),F.end.addScaledVector(o,e)}}});const n=R;n.copy(F.start).applyMatrix4(V.matrixWorld);const i=G;i.subVectors(n,A.position),C=i.y>Math.abs(e*H.y*.25);const o=Math.max(0,i.length()-1e-5);i.normalize().multiplyScalar(o),A.position.add(i),C?H.set(0,0,0):(i.normalize(),H.addScaledVector(i,-i.dot(H))),x.position.sub(B.target),B.target.copy(A.position),x.position.add(A.position),A.position.y<-25&&_()}!function(){const t=1251612;g=new o.WebGLRenderer({antialias:!0}),g.setPixelRatio(window.devicePixelRatio),g.setSize(window.innerWidth,window.innerHeight),g.setClearColor(t,1),g.shadowMap.enabled=!0,g.shadowMap.type=o.PCFSoftShadowMap,g.outputEncoding=o.sRGBEncoding,document.body.appendChild(g.domElement),S=new o.Scene,S.fog=new o.Fog(t,20,70);const a=new o.DirectionalLight(16777215,1);a.position.set(1,1.5,1).multiplyScalar(50),a.shadow.mapSize.setScalar(2048),a.shadow.bias=-1e-4,a.shadow.normalBias=.05,a.castShadow=!0;const n=a.shadow.camera;n.bottom=n.left=-30,n.top=30,n.right=45,S.add(a),S.add(new o.HemisphereLight(16777215,2241348,.4)),x=new o.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50),x.position.set(10,10,-10),x.far=100,x.updateProjectionMatrix(),window.camera=x,b=new o.Clock,B=new u.OrbitControls(x,g.domElement),v=new(e(m)),document.body.appendChild(v.dom),(new p.GLTFLoader).load("../models/dungeon_low_poly_game_level_challenge/scene.gltf",(e=>{const t=e.scene;t.scale.setScalar(.01);const a=new o.Box3;a.setFromObject(t),a.getCenter(t.position).negate(),t.updateMatrixWorld(!0);const n={};t.traverse((e=>{if(!(/Boss/.test(e.name)||/Enemie/.test(e.name)||/Shield/.test(e.name)||/Sword/.test(e.name)||/Character/.test(e.name)||/Gate/.test(e.name)||/Cube/.test(e.name)||e.material&&1===e.material.color.r)&&e.isMesh){const t=e.material.color.getHex();n[t]=n[t]||[],n[t].push(e)}})),z=new o.Group;for(const e in n){const t=n[e],a=[];if(t.forEach((e=>{if(0!==e.material.emissive.r)z.attach(e);else{const t=e.geometry.clone();t.applyMatrix4(e.matrixWorld),a.push(t)}})),a.length){const t=h.mergeBufferGeometries(a),n=new o.Mesh(t,new o.MeshStandardMaterial({color:parseInt(e),shadowSide:2}));n.castShadow=!0,n.receiveShadow=!0,n.material.shadowSide=2,z.add(n)}}const i=[];z.updateMatrixWorld(!0),z.traverse((e=>{if(e.geometry){const t=e.geometry.clone();t.applyMatrix4(e.matrixWorld);for(const e in t.attributes)"position"!==e&&t.deleteAttribute(e);i.push(t)}}));const r=h.mergeBufferGeometries(i,!1);r.boundsTree=new f.MeshBVH(r,{lazyGeneration:!1}),V=new o.Mesh(r),V.material.wireframe=!0,V.material.opacity=.5,V.material.transparent=!0,P=new f.MeshBVHVisualizer(V,w.visualizeDepth),S.add(P),S.add(V),S.add(z)})),A=new o.Mesh(new d(1,2,1,10,.5),new o.MeshStandardMaterial),A.geometry.translate(0,-.5,0),A.capsuleInfo={radius:.5,segment:new o.Line3(new o.Vector3,new o.Vector3(0,-1,0))},A.castShadow=!0,A.receiveShadow=!0,A.material.shadowSide=2,S.add(A),_(),M=new y.GUI,M.add(w,"firstPerson").onChange((e=>{e||x.position.sub(B.target).normalize().multiplyScalar(10).add(B.target)}));const i=M.addFolder("Visualization");i.add(w,"displayCollider"),i.add(w,"displayBVH"),i.add(w,"visualizeDepth",1,20,1).onChange((e=>{P.depth=e,P.update()})),i.open();const r=M.addFolder("Player");r.add(w,"physicsSteps",0,30,1),r.add(w,"gravity",-100,100,.01).onChange((e=>{w.gravity=parseFloat(e)})),r.add(w,"playerSpeed",1,20),r.open(),M.add(w,"reset"),M.open(),window.addEventListener("resize",(function(){x.aspect=window.innerWidth/window.innerHeight,x.updateProjectionMatrix(),g.setSize(window.innerWidth,window.innerHeight)}),!1),window.addEventListener("keydown",(function(e){switch(e.code){case"KeyW":k=!0;break;case"KeyS":E=!0;break;case"KeyD":W=!0;break;case"KeyA":D=!0;break;case"Space":C&&(H.y=10)}})),window.addEventListener("keyup",(function(e){switch(e.code){case"KeyW":k=!1;break;case"KeyS":E=!1;break;case"KeyD":W=!1;break;case"KeyA":D=!1}}))}(),function e(){v.update(),requestAnimationFrame(e);const t=Math.min(b.getDelta(),.1);w.firstPerson?(B.maxPolarAngle=Math.PI,B.minDistance=1e-4,B.maxDistance=1e-4):(B.maxPolarAngle=Math.PI/2,B.minDistance=1,B.maxDistance=20);if(V){V.visible=w.displayCollider,P.visible=w.displayBVH;const e=w.physicsSteps;for(let a=0;a<e;a++)K(t/e)}B.update(),g.render(S,x)}();
//# sourceMappingURL=characterMovement.f20287fd.js.map
